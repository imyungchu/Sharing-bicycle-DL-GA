{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":30070,"status":"ok","timestamp":1652730626460,"user":{"displayName":"Ê±üË©†Á≠ë","userId":"04064959354435451143"},"user_tz":-480},"id":"3eptBgSZCOgt","outputId":"ddc2ad1b-0802-46f5-eb78-553a0caab617"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount(\"/content/drive\")"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"KE0QZiA7CW-j"},"outputs":[],"source":["from glob import glob\n","from datetime import datetime\n","from scipy.stats import ttest_ind\n","from sklearn.preprocessing import MaxAbsScaler\n","\n","import random\n","import calendar\n","import matplotlib.pyplot as plt\n","import seaborn as sns\n","import pandas as pd\n","import numpy as np\n","\n","import pandas as pd\n","import numpy as np\n","from keras.models import Sequential\n","from keras.layers import Dense, Dropout, Activation, Flatten, LSTM, TimeDistributed, RepeatVector,GRU\n","from keras.callbacks import EarlyStopping, ModelCheckpoint\n","import matplotlib.pyplot as plt\n"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":8714,"status":"ok","timestamp":1652730638806,"user":{"displayName":"Ê±üË©†Á≠ë","userId":"04064959354435451143"},"user_tz":-480},"id":"R7idxtqfCaCt","outputId":"6de20e95-2110-452a-d699-ffb4c6cc19d3"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["            started_at                   Start station  \\\n","0  2018-01-01 00:14:30   15th St & Constitution Ave NW   \n","1  2018-01-01 00:14:53   15th St & Constitution Ave NW   \n","2  2018-01-01 00:23:41           Maine Ave & 9th St SW   \n","3  2018-01-01 00:37:44  California St & Florida Ave NW   \n","4  2018-01-01 00:39:24        18th St & Wyoming Ave NW   \n","\n","                     End station               end_at  is_weekend Member type  \\\n","0  15th St & Constitution Ave NW  2018-01-01 00:35:53           0      casual   \n","1  15th St & Constitution Ave NW  2018-01-01 00:35:58           0      casual   \n","2                  4th & M St SW  2018-01-01 00:28:35           0      member   \n","3     14th & Rhode Island Ave NW  2018-01-01 00:44:31           0      member   \n","4                 15th & P St NW  2018-01-01 00:48:54           0      member   \n","\n","  weekday         period  year  month  hour  \n","0  monday  Early morning  2018      1     0  \n","1  monday  Early morning  2018      1     0  \n","2  monday  Early morning  2018      1     0  \n","3  monday  Early morning  2018      1     0  \n","4  monday  Early morning  2018      1     0  "],"text/html":["\n","  <div id=\"df-a217de69-7558-4075-bf7d-b9712892b695\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>started_at</th>\n","      <th>Start station</th>\n","      <th>End station</th>\n","      <th>end_at</th>\n","      <th>is_weekend</th>\n","      <th>Member type</th>\n","      <th>weekday</th>\n","      <th>period</th>\n","      <th>year</th>\n","      <th>month</th>\n","      <th>hour</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>2018-01-01 00:14:30</td>\n","      <td>15th St &amp; Constitution Ave NW</td>\n","      <td>15th St &amp; Constitution Ave NW</td>\n","      <td>2018-01-01 00:35:53</td>\n","      <td>0</td>\n","      <td>casual</td>\n","      <td>monday</td>\n","      <td>Early morning</td>\n","      <td>2018</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>2018-01-01 00:14:53</td>\n","      <td>15th St &amp; Constitution Ave NW</td>\n","      <td>15th St &amp; Constitution Ave NW</td>\n","      <td>2018-01-01 00:35:58</td>\n","      <td>0</td>\n","      <td>casual</td>\n","      <td>monday</td>\n","      <td>Early morning</td>\n","      <td>2018</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2018-01-01 00:23:41</td>\n","      <td>Maine Ave &amp; 9th St SW</td>\n","      <td>4th &amp; M St SW</td>\n","      <td>2018-01-01 00:28:35</td>\n","      <td>0</td>\n","      <td>member</td>\n","      <td>monday</td>\n","      <td>Early morning</td>\n","      <td>2018</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>2018-01-01 00:37:44</td>\n","      <td>California St &amp; Florida Ave NW</td>\n","      <td>14th &amp; Rhode Island Ave NW</td>\n","      <td>2018-01-01 00:44:31</td>\n","      <td>0</td>\n","      <td>member</td>\n","      <td>monday</td>\n","      <td>Early morning</td>\n","      <td>2018</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>2018-01-01 00:39:24</td>\n","      <td>18th St &amp; Wyoming Ave NW</td>\n","      <td>15th &amp; P St NW</td>\n","      <td>2018-01-01 00:48:54</td>\n","      <td>0</td>\n","      <td>member</td>\n","      <td>monday</td>\n","      <td>Early morning</td>\n","      <td>2018</td>\n","      <td>1</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-a217de69-7558-4075-bf7d-b9712892b695')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-a217de69-7558-4075-bf7d-b9712892b695 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-a217de69-7558-4075-bf7d-b9712892b695');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":3}],"source":["# ÈÄ≤Á´ôÊµÅÈáèÂâç20ÂêçÁöÑÁ´ôÈªûË≥áÊñô\n","start_st = pd.read_csv('/content/drive/MyDrive/Â∞àÈ°åÁ†îÁ©∂üí™/sharingbike/ReturnTop20.csv')\n","start_st.head() "]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":708},"executionInfo":{"elapsed":24,"status":"ok","timestamp":1652730638808,"user":{"displayName":"Ê±üË©†Á≠ë","userId":"04064959354435451143"},"user_tz":-480},"id":"2VvDQ0Kub3Nm","outputId":"a790d782-dd15-4293-b95b-29d47d5d190d"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                      hour\n","End station                                               \n","Columbus Circle / Union Station                     171739\n","Lincoln Memorial                                    139388\n","15th & P St NW                                      130303\n","Jefferson Dr & 14th St SW                           126061\n","4th St & Madison Dr NW                              122195\n","Henry Bacon Dr & Lincoln Memorial Circle NW         117182\n","Massachusetts Ave & Dupont Circle NW                115847\n","1st & M St NE                                       112761\n","Smithsonian-National Mall / Jefferson Dr & 12th...  111238\n","New Hampshire Ave & T St NW                         109102\n","14th & V St NW                                      102164\n","Jefferson Memorial                                   92360\n","15th St & Constitution Ave NW                        85189\n","14th & Rhode Island Ave NW                           84814\n","5th & K St NW                                        84197\n","4th & M St SW                                        83761\n","8th & O St NW                                        83386\n","Thomas Circle                                        81600\n","11th & M St NW                                       76358\n","14th & Irving St NW                                  60939"],"text/html":["\n","  <div id=\"df-45274b29-7ebf-4488-badf-13672308e89e\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>hour</th>\n","    </tr>\n","    <tr>\n","      <th>End station</th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>Columbus Circle / Union Station</th>\n","      <td>171739</td>\n","    </tr>\n","    <tr>\n","      <th>Lincoln Memorial</th>\n","      <td>139388</td>\n","    </tr>\n","    <tr>\n","      <th>15th &amp; P St NW</th>\n","      <td>130303</td>\n","    </tr>\n","    <tr>\n","      <th>Jefferson Dr &amp; 14th St SW</th>\n","      <td>126061</td>\n","    </tr>\n","    <tr>\n","      <th>4th St &amp; Madison Dr NW</th>\n","      <td>122195</td>\n","    </tr>\n","    <tr>\n","      <th>Henry Bacon Dr &amp; Lincoln Memorial Circle NW</th>\n","      <td>117182</td>\n","    </tr>\n","    <tr>\n","      <th>Massachusetts Ave &amp; Dupont Circle NW</th>\n","      <td>115847</td>\n","    </tr>\n","    <tr>\n","      <th>1st &amp; M St NE</th>\n","      <td>112761</td>\n","    </tr>\n","    <tr>\n","      <th>Smithsonian-National Mall / Jefferson Dr &amp; 12th St SW</th>\n","      <td>111238</td>\n","    </tr>\n","    <tr>\n","      <th>New Hampshire Ave &amp; T St NW</th>\n","      <td>109102</td>\n","    </tr>\n","    <tr>\n","      <th>14th &amp; V St NW</th>\n","      <td>102164</td>\n","    </tr>\n","    <tr>\n","      <th>Jefferson Memorial</th>\n","      <td>92360</td>\n","    </tr>\n","    <tr>\n","      <th>15th St &amp; Constitution Ave NW</th>\n","      <td>85189</td>\n","    </tr>\n","    <tr>\n","      <th>14th &amp; Rhode Island Ave NW</th>\n","      <td>84814</td>\n","    </tr>\n","    <tr>\n","      <th>5th &amp; K St NW</th>\n","      <td>84197</td>\n","    </tr>\n","    <tr>\n","      <th>4th &amp; M St SW</th>\n","      <td>83761</td>\n","    </tr>\n","    <tr>\n","      <th>8th &amp; O St NW</th>\n","      <td>83386</td>\n","    </tr>\n","    <tr>\n","      <th>Thomas Circle</th>\n","      <td>81600</td>\n","    </tr>\n","    <tr>\n","      <th>11th &amp; M St NW</th>\n","      <td>76358</td>\n","    </tr>\n","    <tr>\n","      <th>14th &amp; Irving St NW</th>\n","      <td>60939</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-45274b29-7ebf-4488-badf-13672308e89e')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-45274b29-7ebf-4488-badf-13672308e89e button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-45274b29-7ebf-4488-badf-13672308e89e');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":4}],"source":["# ÊØèÁ´ôÂÄüËªäÈáè(ÊúÄÂ§ßÂà∞ÊúÄÂ∞è)\n","station_count =pd.DataFrame(start_st.groupby(['End station'])['hour'].count())\n","station_count.sort_values(by=['hour'], inplace=True, ascending=False)\n","station_rank = list(station_count.index)\n","station_count"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":455},"executionInfo":{"elapsed":2071,"status":"ok","timestamp":1652730640858,"user":{"displayName":"Ê±üË©†Á≠ë","userId":"04064959354435451143"},"user_tz":-480},"id":"wHK0hT7OFdwS","outputId":"55d78740-6e78-4f3c-ba24-3fe4a6d76a3e"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                  End station    groupby_col  to_cnt\n","groupby_col                                         \n","2018-01-01 01  11th & M St NW  2018-01-01 01       2\n","2018-01-01 02  11th & M St NW  2018-01-01 02       4\n","2018-01-01 10  11th & M St NW  2018-01-01 10       1\n","2018-01-01 11  11th & M St NW  2018-01-01 11       1\n","2018-01-01 12  11th & M St NW  2018-01-01 12       2\n","...                       ...            ...     ...\n","2021-12-31 17   Thomas Circle  2021-12-31 17       2\n","2021-12-31 19   Thomas Circle  2021-12-31 19       2\n","2021-12-31 20   Thomas Circle  2021-12-31 20       1\n","2021-12-31 21   Thomas Circle  2021-12-31 21       1\n","2022-01-01 00   Thomas Circle  2022-01-01 00       1\n","\n","[433872 rows x 3 columns]"],"text/html":["\n","  <div id=\"df-3a9e4240-a601-48c5-bc44-c4045d940411\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>End station</th>\n","      <th>groupby_col</th>\n","      <th>to_cnt</th>\n","    </tr>\n","    <tr>\n","      <th>groupby_col</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>2018-01-01 01</th>\n","      <td>11th &amp; M St NW</td>\n","      <td>2018-01-01 01</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>2018-01-01 02</th>\n","      <td>11th &amp; M St NW</td>\n","      <td>2018-01-01 02</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>2018-01-01 10</th>\n","      <td>11th &amp; M St NW</td>\n","      <td>2018-01-01 10</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2018-01-01 11</th>\n","      <td>11th &amp; M St NW</td>\n","      <td>2018-01-01 11</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2018-01-01 12</th>\n","      <td>11th &amp; M St NW</td>\n","      <td>2018-01-01 12</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>2021-12-31 17</th>\n","      <td>Thomas Circle</td>\n","      <td>2021-12-31 17</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>2021-12-31 19</th>\n","      <td>Thomas Circle</td>\n","      <td>2021-12-31 19</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>2021-12-31 20</th>\n","      <td>Thomas Circle</td>\n","      <td>2021-12-31 20</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2021-12-31 21</th>\n","      <td>Thomas Circle</td>\n","      <td>2021-12-31 21</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2022-01-01 00</th>\n","      <td>Thomas Circle</td>\n","      <td>2022-01-01 00</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>433872 rows √ó 3 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-3a9e4240-a601-48c5-bc44-c4045d940411')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-3a9e4240-a601-48c5-bc44-c4045d940411 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-3a9e4240-a601-48c5-bc44-c4045d940411');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":5}],"source":["#Êääend time Ë®≠ÁÇ∫ index\n","start_st.set_index('end_at', inplace = True)\n","\n","#Ê†πÊìöÊôÇÈñì(Â∞èÊôÇÁÇ∫ÂñÆ‰Ωç)‰æÜÂàÜÁæ§\n","start_st['groupby_col'] = start_st.index.map(lambda x:str(x)[:13])\n","# Ë®àÁÆóÂêÑÁ´ôÈªûÊØèÂ∞èÊôÇÂÄüËªäÈáè\n","start_st_model =pd.DataFrame(start_st.groupby(['End station', 'groupby_col'])['hour'].count())\n","\n","# Rename the 'hour' to 'from_cnt'\n","# Make the 'grouby_col' the index\n","start_st_model.rename(columns={'hour':'to_cnt'}, inplace=True)\n","start_st_model.reset_index(inplace=True)\n","start_st_model.index = start_st_model['groupby_col']\n","\n","start_st_model\n","# ÁèæÂú®Ë≥áÊñôÁÇ∫Ë©≤ÊôÇÊÆµ Âì™‰∏ÄÁ´ôÈªû Ë¶ÅÂÄüÂπæÂè∞Ëªä(ÊòØÈúÄË¶ÅÈ†êÊ∏¨ÊôÇÁöÑË≥áÊñôËº∏ÂÖ•ÂûãÊÖã)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"0J9duJQDeN4I"},"outputs":[],"source":["# functions def\n","\n","# ÁØ©Á´ôÈªûË≥áÊñô\n","def produce_picked_station_data(all_station_data, station_name):\n","  fliter = (all_station_data['End station'] == station_name)\n","  picked_station_data = all_station_data[fliter]\n","  return picked_station_data \n","\n","\n","def feature_extractor0(data, time_data):\n","  data['groupby_col'] = pd.to_datetime(data['groupby_col'])\n","  data.drop('End station', axis=1, inplace=True)\n","  data = data.rename(columns={\"groupby_col\":\"Time\"})\n","  #Â∞áÁõ∏ÂêåÊôÇÈñìÈñìÈöîÁöÑÊôÇÈñìË°®ËàáÈÄ≤Á´ôÈõ¢Á´ôË≥áË®äÂÅöÁµêÂêà\n","  data['Time'] = pd.to_datetime(data['Time'])\n","  data = pd.merge(time_data, data,on=['Time'],how='left')\n","  # NaNË£ú0\n","  data = data.fillna(0)\n","  # Â∞áTimeË®≠ÁÇ∫index\n","  data.index = data['Time']\n","  data['year'] = data.index.map(lambda x:str(x)[:4])  \n","  data['month'] = data.index.map(lambda x:str(x)[5:7])\n","  data['hour'] = data.index.map(lambda x:str(x)[11:13])\n","  data['day'] = data.index.day_name()\n","  data.drop('Time', axis=1, inplace=True)\n","  # print('data info')\n","  # print(data.info())\n","  # print('from_cnt data describe')\n","  # print(data['from_cnt'].describe())\n","  data.reset_index(inplace=True)\n","  data = data.drop(['Time', 'year'],axis=1)\n","  ## 'Start station', 'year', 'month', 'day', 'hour' columns to be converted to dummies\n","  data = pd.get_dummies(data=data, columns=['month', 'day', 'hour'])  \n","  # print('data check')\n","  # print(data)\n","  return data\n","\n","\n","def feature_extractor1(data, time_data):\n","\n","\n","  return data\n","\n","\n","def feature_engineering(data, time_data, index=0):\n","  if index == 0:\n","    featured_data = feature_extractor0(data, time_data)\n","  else:\n","    featured_data = feature_extractor1(data, time_data)\n","  return featured_data\n","\n","\n","def scaling(data, column_name='to_cnt'):\n","  ##ÈÄ≤Ë°åË≥áÊñôÊ®ôÊ∫ñÂåñ\n","  scaler = MaxAbsScaler()\n","  data[column_name] = scaler.fit_transform(data[column_name].values.reshape(-1,1))\n","  return data\n","\n","\n","def build_training_data(full_data, used_days):\n","  x_train = []   #È†êÊ∏¨ÈªûÁöÑÂâç 7 Â§©ÁöÑË≥áÊñô\n","  y_train = []   #È†êÊ∏¨Èªû\n","  Pasthours = 24 * used_days\n","  Futurehours = 1\n","  for i in range(full_data.shape[0]-Pasthours-Futurehours):  \n","    x_train.append(np.array(full_data.iloc[i:i+Pasthours]))\n","    y_train.append(np.array(full_data.iloc[i+Pasthours:i+Pasthours+Futurehours][\"to_cnt\"]))\n","  x_train, y_train = np.array(x_train), np.array(y_train)  # ËΩâÊàênumpy arrayÁöÑÊ†ºÂºèÔºå‰ª•Âà©Ëº∏ÂÖ•LSTM\n","  return x_train, y_train\n","\n","\n","def build_training_and_validation_data(x_train, y_train, rate):\n","  X_train = x_train[int(x_train.shape[0]*rate):]\n","  Y_train = y_train[int(y_train.shape[0]*rate):]\n","  X_val = x_train[:int(x_train.shape[0]*rate)]\n","  Y_val = y_train[:int(y_train.shape[0]*rate)]\n","  return X_train, Y_train, X_val, Y_val\n","\n","\n","# Êâì‰∫ÇË≥áÊñô\n","def shuffle(X,Y):\n","  np.random.seed(10)\n","  randomList = np.arange(X.shape[0])\n","  np.random.shuffle(randomList)\n","  return X[randomList], Y[randomList]\n","\n","\n","def buildManyToOneModel(shape):\n","  model = Sequential()\n","  model.add(GRU(20, input_shape=(shape[1],shape[2]),return_sequences=True))\n","  model.add(GRU(10, input_shape=(shape[1],shape[2]),return_sequences=False))\n","  model.add(Dropout(0.05))\n","  model.add(Dense(10))\n","  model.add(Dense(1))\n","  model.compile(loss=\"mse\", optimizer=\"Adam\")\n","  model.summary()\n","  return model"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"s5PLSMxbbax-","outputId":"c3b043fc-93b2-4ffd-c842-cb8dacde6b63","executionInfo":{"status":"ok","timestamp":1652738921355,"user_tz":-480,"elapsed":8280520,"user":{"displayName":"Ê±üË©†Á≠ë","userId":"04064959354435451143"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["index =  0\n","model building for  Columbus Circle / Union Station  start\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:11: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  # This is added back by InteractiveShellApp.init_path()\n","/usr/local/lib/python3.7/dist-packages/pandas/core/frame.py:4913: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  errors=errors,\n"]},{"output_type":"stream","name":"stdout","text":["Model: \"sequential\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," gru (GRU)                   (None, 168, 20)           3960      \n","                                                                 \n"," gru_1 (GRU)                 (None, 10)                960       \n","                                                                 \n"," dropout (Dropout)           (None, 10)                0         \n","                                                                 \n"," dense (Dense)               (None, 10)                110       \n","                                                                 \n"," dense_1 (Dense)             (None, 1)                 11        \n","                                                                 \n","=================================================================\n","Total params: 5,041\n","Trainable params: 5,041\n","Non-trainable params: 0\n","_________________________________________________________________\n","Epoch 1/20\n","280/280 [==============================] - 28s 73ms/step - loss: 0.0137 - val_loss: 0.0073\n","Epoch 2/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0070 - val_loss: 0.0053\n","Epoch 3/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0054 - val_loss: 0.0046\n","Epoch 4/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0047 - val_loss: 0.0042\n","Epoch 5/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0043 - val_loss: 0.0040\n","Epoch 6/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0040 - val_loss: 0.0038\n","Epoch 7/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0038 - val_loss: 0.0034\n","Epoch 8/20\n","280/280 [==============================] - 20s 71ms/step - loss: 0.0035 - val_loss: 0.0032\n","Epoch 9/20\n","280/280 [==============================] - 20s 71ms/step - loss: 0.0032 - val_loss: 0.0026\n","Epoch 10/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0029 - val_loss: 0.0026\n","Epoch 11/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0027 - val_loss: 0.0025\n","Epoch 12/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0026 - val_loss: 0.0024\n","Epoch 13/20\n","280/280 [==============================] - 20s 71ms/step - loss: 0.0026 - val_loss: 0.0024\n","Epoch 14/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0025 - val_loss: 0.0023\n","Epoch 15/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0026 - val_loss: 0.0024\n","Epoch 16/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0025 - val_loss: 0.0023\n","Epoch 17/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0025 - val_loss: 0.0023\n","Epoch 18/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0025 - val_loss: 0.0023\n","Epoch 19/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0025 - val_loss: 0.0023\n","Epoch 20/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0024 - val_loss: 0.0023\n","model building for  Columbus Circle / Union Station  done\n","index =  1\n","model building for  Lincoln Memorial  start\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:11: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  # This is added back by InteractiveShellApp.init_path()\n","/usr/local/lib/python3.7/dist-packages/pandas/core/frame.py:4913: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  errors=errors,\n"]},{"output_type":"stream","name":"stdout","text":["Model: \"sequential_1\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," gru_2 (GRU)                 (None, 168, 20)           3960      \n","                                                                 \n"," gru_3 (GRU)                 (None, 10)                960       \n","                                                                 \n"," dropout_1 (Dropout)         (None, 10)                0         \n","                                                                 \n"," dense_2 (Dense)             (None, 10)                110       \n","                                                                 \n"," dense_3 (Dense)             (None, 1)                 11        \n","                                                                 \n","=================================================================\n","Total params: 5,041\n","Trainable params: 5,041\n","Non-trainable params: 0\n","_________________________________________________________________\n","Epoch 1/20\n","280/280 [==============================] - 23s 70ms/step - loss: 0.0061 - val_loss: 0.0033\n","Epoch 2/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0033 - val_loss: 0.0026\n","Epoch 3/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0029 - val_loss: 0.0025\n","Epoch 4/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0028 - val_loss: 0.0025\n","Epoch 5/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0027 - val_loss: 0.0024\n","Epoch 6/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0027 - val_loss: 0.0025\n","Epoch 7/20\n","280/280 [==============================] - 20s 70ms/step - loss: 0.0026 - val_loss: 0.0025\n","Epoch 8/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0027 - val_loss: 0.0024\n","Epoch 9/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0026 - val_loss: 0.0024\n","Epoch 10/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0026 - val_loss: 0.0025\n","Epoch 11/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0026 - val_loss: 0.0024\n","Epoch 12/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0026 - val_loss: 0.0024\n","Epoch 13/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0025 - val_loss: 0.0024\n","Epoch 14/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0026 - val_loss: 0.0024\n","Epoch 15/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0025 - val_loss: 0.0024\n","Epoch 16/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0025 - val_loss: 0.0024\n","Epoch 17/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0025 - val_loss: 0.0023\n","Epoch 18/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0025 - val_loss: 0.0025\n","Epoch 19/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0025 - val_loss: 0.0023\n","Epoch 20/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0025 - val_loss: 0.0024\n","model building for  Lincoln Memorial  done\n","index =  2\n","model building for  15th & P St NW  start\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:11: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  # This is added back by InteractiveShellApp.init_path()\n","/usr/local/lib/python3.7/dist-packages/pandas/core/frame.py:4913: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  errors=errors,\n"]},{"output_type":"stream","name":"stdout","text":["Model: \"sequential_2\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," gru_4 (GRU)                 (None, 168, 20)           3960      \n","                                                                 \n"," gru_5 (GRU)                 (None, 10)                960       \n","                                                                 \n"," dropout_2 (Dropout)         (None, 10)                0         \n","                                                                 \n"," dense_4 (Dense)             (None, 10)                110       \n","                                                                 \n"," dense_5 (Dense)             (None, 1)                 11        \n","                                                                 \n","=================================================================\n","Total params: 5,041\n","Trainable params: 5,041\n","Non-trainable params: 0\n","_________________________________________________________________\n","Epoch 1/20\n","280/280 [==============================] - 24s 73ms/step - loss: 0.0124 - val_loss: 0.0080\n","Epoch 2/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0079 - val_loss: 0.0071\n","Epoch 3/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0074 - val_loss: 0.0069\n","Epoch 4/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0072 - val_loss: 0.0068\n","Epoch 5/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0070 - val_loss: 0.0068\n","Epoch 6/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0069 - val_loss: 0.0066\n","Epoch 7/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0068 - val_loss: 0.0065\n","Epoch 8/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0068 - val_loss: 0.0065\n","Epoch 9/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0068 - val_loss: 0.0065\n","Epoch 10/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0067 - val_loss: 0.0065\n","Epoch 11/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0067 - val_loss: 0.0064\n","Epoch 12/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0065 - val_loss: 0.0062\n","Epoch 13/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0063 - val_loss: 0.0061\n","Epoch 14/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0062 - val_loss: 0.0059\n","Epoch 15/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0061 - val_loss: 0.0058\n","Epoch 16/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0061 - val_loss: 0.0060\n","Epoch 17/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0060 - val_loss: 0.0058\n","Epoch 18/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0060 - val_loss: 0.0058\n","Epoch 19/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0060 - val_loss: 0.0058\n","Epoch 20/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0060 - val_loss: 0.0058\n","model building for  15th & P St NW  done\n","index =  3\n","model building for  Jefferson Dr & 14th St SW  start\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:11: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  # This is added back by InteractiveShellApp.init_path()\n","/usr/local/lib/python3.7/dist-packages/pandas/core/frame.py:4913: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  errors=errors,\n"]},{"output_type":"stream","name":"stdout","text":["Model: \"sequential_3\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," gru_6 (GRU)                 (None, 168, 20)           3960      \n","                                                                 \n"," gru_7 (GRU)                 (None, 10)                960       \n","                                                                 \n"," dropout_3 (Dropout)         (None, 10)                0         \n","                                                                 \n"," dense_6 (Dense)             (None, 10)                110       \n","                                                                 \n"," dense_7 (Dense)             (None, 1)                 11        \n","                                                                 \n","=================================================================\n","Total params: 5,041\n","Trainable params: 5,041\n","Non-trainable params: 0\n","_________________________________________________________________\n","Epoch 1/20\n","280/280 [==============================] - 23s 71ms/step - loss: 0.0077 - val_loss: 0.0011\n","Epoch 2/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0012 - val_loss: 9.7513e-04\n","Epoch 3/20\n","280/280 [==============================] - 19s 70ms/step - loss: 0.0010 - val_loss: 9.3661e-04\n","Epoch 4/20\n","280/280 [==============================] - 19s 67ms/step - loss: 9.3587e-04 - val_loss: 0.0010\n","Epoch 5/20\n","280/280 [==============================] - 19s 67ms/step - loss: 9.0469e-04 - val_loss: 9.1538e-04\n","Epoch 6/20\n","280/280 [==============================] - 19s 67ms/step - loss: 8.8165e-04 - val_loss: 8.8454e-04\n","Epoch 7/20\n","280/280 [==============================] - 19s 67ms/step - loss: 8.7529e-04 - val_loss: 8.5630e-04\n","Epoch 8/20\n","280/280 [==============================] - 19s 67ms/step - loss: 8.6577e-04 - val_loss: 8.4602e-04\n","Epoch 9/20\n","280/280 [==============================] - 19s 67ms/step - loss: 8.6033e-04 - val_loss: 8.5120e-04\n","Epoch 10/20\n","280/280 [==============================] - 19s 67ms/step - loss: 8.5320e-04 - val_loss: 8.4042e-04\n","Epoch 11/20\n","280/280 [==============================] - 19s 67ms/step - loss: 8.6210e-04 - val_loss: 8.9632e-04\n","Epoch 12/20\n","280/280 [==============================] - 19s 66ms/step - loss: 8.3985e-04 - val_loss: 8.7025e-04\n","Epoch 13/20\n","280/280 [==============================] - 19s 66ms/step - loss: 8.4515e-04 - val_loss: 8.3607e-04\n","Epoch 14/20\n","280/280 [==============================] - 19s 69ms/step - loss: 8.3193e-04 - val_loss: 8.3797e-04\n","Epoch 15/20\n","280/280 [==============================] - 19s 67ms/step - loss: 8.2730e-04 - val_loss: 8.4070e-04\n","Epoch 16/20\n","280/280 [==============================] - 19s 66ms/step - loss: 8.1804e-04 - val_loss: 8.1764e-04\n","Epoch 17/20\n","280/280 [==============================] - 19s 66ms/step - loss: 8.2214e-04 - val_loss: 8.3588e-04\n","Epoch 18/20\n","280/280 [==============================] - 19s 66ms/step - loss: 8.1633e-04 - val_loss: 8.3377e-04\n","Epoch 19/20\n","280/280 [==============================] - 19s 67ms/step - loss: 8.1136e-04 - val_loss: 8.1744e-04\n","Epoch 20/20\n","280/280 [==============================] - 19s 66ms/step - loss: 8.1240e-04 - val_loss: 8.3321e-04\n","model building for  Jefferson Dr & 14th St SW  done\n","index =  4\n","model building for  4th St & Madison Dr NW  start\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:11: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  # This is added back by InteractiveShellApp.init_path()\n","/usr/local/lib/python3.7/dist-packages/pandas/core/frame.py:4913: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  errors=errors,\n"]},{"output_type":"stream","name":"stdout","text":["Model: \"sequential_4\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," gru_8 (GRU)                 (None, 168, 20)           3960      \n","                                                                 \n"," gru_9 (GRU)                 (None, 10)                960       \n","                                                                 \n"," dropout_4 (Dropout)         (None, 10)                0         \n","                                                                 \n"," dense_8 (Dense)             (None, 10)                110       \n","                                                                 \n"," dense_9 (Dense)             (None, 1)                 11        \n","                                                                 \n","=================================================================\n","Total params: 5,041\n","Trainable params: 5,041\n","Non-trainable params: 0\n","_________________________________________________________________\n","Epoch 1/20\n","280/280 [==============================] - 23s 70ms/step - loss: 0.0061 - val_loss: 0.0039\n","Epoch 2/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0038 - val_loss: 0.0034\n","Epoch 3/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0035 - val_loss: 0.0032\n","Epoch 4/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0034 - val_loss: 0.0031\n","Epoch 5/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0033 - val_loss: 0.0032\n","Epoch 6/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0033 - val_loss: 0.0031\n","Epoch 7/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0033 - val_loss: 0.0032\n","Epoch 8/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0032 - val_loss: 0.0030\n","Epoch 9/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0032 - val_loss: 0.0030\n","Epoch 10/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0032 - val_loss: 0.0030\n","Epoch 11/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0032 - val_loss: 0.0030\n","Epoch 12/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0032 - val_loss: 0.0031\n","Epoch 13/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0032 - val_loss: 0.0030\n","Epoch 14/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0031 - val_loss: 0.0030\n","Epoch 15/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0031 - val_loss: 0.0030\n","Epoch 16/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0032 - val_loss: 0.0030\n","Epoch 17/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0031 - val_loss: 0.0030\n","Epoch 18/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0031 - val_loss: 0.0030\n","Epoch 19/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0031 - val_loss: 0.0029\n","Epoch 20/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0031 - val_loss: 0.0029\n","model building for  4th St & Madison Dr NW  done\n","index =  5\n","model building for  Henry Bacon Dr & Lincoln Memorial Circle NW  start\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:11: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  # This is added back by InteractiveShellApp.init_path()\n","/usr/local/lib/python3.7/dist-packages/pandas/core/frame.py:4913: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  errors=errors,\n"]},{"output_type":"stream","name":"stdout","text":["Model: \"sequential_5\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," gru_10 (GRU)                (None, 168, 20)           3960      \n","                                                                 \n"," gru_11 (GRU)                (None, 10)                960       \n","                                                                 \n"," dropout_5 (Dropout)         (None, 10)                0         \n","                                                                 \n"," dense_10 (Dense)            (None, 10)                110       \n","                                                                 \n"," dense_11 (Dense)            (None, 1)                 11        \n","                                                                 \n","=================================================================\n","Total params: 5,041\n","Trainable params: 5,041\n","Non-trainable params: 0\n","_________________________________________________________________\n","Epoch 1/20\n","280/280 [==============================] - 23s 71ms/step - loss: 0.0066 - val_loss: 0.0041\n","Epoch 2/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0036 - val_loss: 0.0032\n","Epoch 3/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0031 - val_loss: 0.0029\n","Epoch 4/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0029 - val_loss: 0.0028\n","Epoch 5/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0029 - val_loss: 0.0028\n","Epoch 6/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0028 - val_loss: 0.0028\n","Epoch 7/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0028 - val_loss: 0.0027\n","Epoch 8/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0028 - val_loss: 0.0027\n","Epoch 9/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0028 - val_loss: 0.0026\n","Epoch 10/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0027 - val_loss: 0.0027\n","Epoch 11/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0028 - val_loss: 0.0027\n","Epoch 12/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0027 - val_loss: 0.0026\n","Epoch 13/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0027 - val_loss: 0.0027\n","Epoch 14/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0027 - val_loss: 0.0026\n","Epoch 15/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0027 - val_loss: 0.0027\n","Epoch 16/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0027 - val_loss: 0.0026\n","Epoch 17/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0027 - val_loss: 0.0026\n","Epoch 18/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0027 - val_loss: 0.0026\n","Epoch 19/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0026 - val_loss: 0.0027\n","Epoch 20/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0026 - val_loss: 0.0026\n","model building for  Henry Bacon Dr & Lincoln Memorial Circle NW  done\n","index =  6\n","model building for  Massachusetts Ave & Dupont Circle NW  start\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:11: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  # This is added back by InteractiveShellApp.init_path()\n","/usr/local/lib/python3.7/dist-packages/pandas/core/frame.py:4913: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  errors=errors,\n"]},{"output_type":"stream","name":"stdout","text":["Model: \"sequential_6\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," gru_12 (GRU)                (None, 168, 20)           3960      \n","                                                                 \n"," gru_13 (GRU)                (None, 10)                960       \n","                                                                 \n"," dropout_6 (Dropout)         (None, 10)                0         \n","                                                                 \n"," dense_12 (Dense)            (None, 10)                110       \n","                                                                 \n"," dense_13 (Dense)            (None, 1)                 11        \n","                                                                 \n","=================================================================\n","Total params: 5,041\n","Trainable params: 5,041\n","Non-trainable params: 0\n","_________________________________________________________________\n","Epoch 1/20\n","280/280 [==============================] - 24s 71ms/step - loss: 0.0109 - val_loss: 0.0065\n","Epoch 2/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0062 - val_loss: 0.0059\n","Epoch 3/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0056 - val_loss: 0.0053\n","Epoch 4/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0053 - val_loss: 0.0051\n","Epoch 5/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0051 - val_loss: 0.0050\n","Epoch 6/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0050 - val_loss: 0.0049\n","Epoch 7/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0050 - val_loss: 0.0049\n","Epoch 8/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0048 - val_loss: 0.0048\n","Epoch 9/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0047 - val_loss: 0.0046\n","Epoch 10/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0045 - val_loss: 0.0044\n","Epoch 11/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0043 - val_loss: 0.0042\n","Epoch 12/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0042 - val_loss: 0.0042\n","Epoch 13/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0040 - val_loss: 0.0041\n","Epoch 14/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0040 - val_loss: 0.0041\n","Epoch 15/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0040 - val_loss: 0.0040\n","Epoch 16/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0040 - val_loss: 0.0040\n","Epoch 17/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0039 - val_loss: 0.0040\n","Epoch 18/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0039 - val_loss: 0.0041\n","Epoch 19/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0039 - val_loss: 0.0040\n","Epoch 20/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0039 - val_loss: 0.0039\n","model building for  Massachusetts Ave & Dupont Circle NW  done\n","index =  7\n","model building for  1st & M St NE  start\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:11: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  # This is added back by InteractiveShellApp.init_path()\n","/usr/local/lib/python3.7/dist-packages/pandas/core/frame.py:4913: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  errors=errors,\n"]},{"output_type":"stream","name":"stdout","text":["Model: \"sequential_7\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," gru_14 (GRU)                (None, 168, 20)           3960      \n","                                                                 \n"," gru_15 (GRU)                (None, 10)                960       \n","                                                                 \n"," dropout_7 (Dropout)         (None, 10)                0         \n","                                                                 \n"," dense_14 (Dense)            (None, 10)                110       \n","                                                                 \n"," dense_15 (Dense)            (None, 1)                 11        \n","                                                                 \n","=================================================================\n","Total params: 5,041\n","Trainable params: 5,041\n","Non-trainable params: 0\n","_________________________________________________________________\n","Epoch 1/20\n","280/280 [==============================] - 23s 71ms/step - loss: 0.0100 - val_loss: 0.0073\n","Epoch 2/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0075 - val_loss: 0.0065\n","Epoch 3/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0069 - val_loss: 0.0063\n","Epoch 4/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0066 - val_loss: 0.0062\n","Epoch 5/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0065 - val_loss: 0.0061\n","Epoch 6/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0064 - val_loss: 0.0063\n","Epoch 7/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0063 - val_loss: 0.0059\n","Epoch 8/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0063 - val_loss: 0.0060\n","Epoch 9/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0062 - val_loss: 0.0058\n","Epoch 10/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0060 - val_loss: 0.0057\n","Epoch 11/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0059 - val_loss: 0.0057\n","Epoch 12/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0057 - val_loss: 0.0054\n","Epoch 13/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0057 - val_loss: 0.0054\n","Epoch 14/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0056 - val_loss: 0.0057\n","Epoch 15/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0057 - val_loss: 0.0053\n","Epoch 16/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0056 - val_loss: 0.0054\n","Epoch 17/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0055 - val_loss: 0.0055\n","Epoch 18/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0055 - val_loss: 0.0054\n","Epoch 19/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0055 - val_loss: 0.0053\n","Epoch 20/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0055 - val_loss: 0.0053\n","model building for  1st & M St NE  done\n","index =  8\n","model building for  Smithsonian-National Mall / Jefferson Dr & 12th St SW  start\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:11: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  # This is added back by InteractiveShellApp.init_path()\n","/usr/local/lib/python3.7/dist-packages/pandas/core/frame.py:4913: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  errors=errors,\n"]},{"output_type":"stream","name":"stdout","text":["Model: \"sequential_8\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," gru_16 (GRU)                (None, 168, 20)           3960      \n","                                                                 \n"," gru_17 (GRU)                (None, 10)                960       \n","                                                                 \n"," dropout_8 (Dropout)         (None, 10)                0         \n","                                                                 \n"," dense_16 (Dense)            (None, 10)                110       \n","                                                                 \n"," dense_17 (Dense)            (None, 1)                 11        \n","                                                                 \n","=================================================================\n","Total params: 5,041\n","Trainable params: 5,041\n","Non-trainable params: 0\n","_________________________________________________________________\n","Epoch 1/20\n","280/280 [==============================] - 23s 71ms/step - loss: 0.0054 - val_loss: 0.0029\n","Epoch 2/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0027 - val_loss: 0.0023\n","Epoch 3/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0024 - val_loss: 0.0022\n","Epoch 4/20\n","280/280 [==============================] - 20s 71ms/step - loss: 0.0023 - val_loss: 0.0022\n","Epoch 5/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0023 - val_loss: 0.0022\n","Epoch 6/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0022 - val_loss: 0.0022\n","Epoch 7/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0022 - val_loss: 0.0022\n","Epoch 8/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0022 - val_loss: 0.0022\n","Epoch 9/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0022 - val_loss: 0.0021\n","Epoch 10/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0022 - val_loss: 0.0021\n","Epoch 11/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0022 - val_loss: 0.0021\n","Epoch 12/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0021 - val_loss: 0.0021\n","Epoch 13/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0021 - val_loss: 0.0021\n","Epoch 14/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0021 - val_loss: 0.0021\n","Epoch 15/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0021 - val_loss: 0.0022\n","Epoch 16/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0021 - val_loss: 0.0021\n","Epoch 17/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0021 - val_loss: 0.0022\n","Epoch 18/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0021 - val_loss: 0.0021\n","Epoch 19/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0021 - val_loss: 0.0021\n","Epoch 20/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0021 - val_loss: 0.0021\n","model building for  Smithsonian-National Mall / Jefferson Dr & 12th St SW  done\n","index =  9\n","model building for  New Hampshire Ave & T St NW  start\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:11: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  # This is added back by InteractiveShellApp.init_path()\n","/usr/local/lib/python3.7/dist-packages/pandas/core/frame.py:4913: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  errors=errors,\n"]},{"output_type":"stream","name":"stdout","text":["Model: \"sequential_9\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," gru_18 (GRU)                (None, 168, 20)           3960      \n","                                                                 \n"," gru_19 (GRU)                (None, 10)                960       \n","                                                                 \n"," dropout_9 (Dropout)         (None, 10)                0         \n","                                                                 \n"," dense_18 (Dense)            (None, 10)                110       \n","                                                                 \n"," dense_19 (Dense)            (None, 1)                 11        \n","                                                                 \n","=================================================================\n","Total params: 5,041\n","Trainable params: 5,041\n","Non-trainable params: 0\n","_________________________________________________________________\n","Epoch 1/20\n","280/280 [==============================] - 24s 71ms/step - loss: 0.0068 - val_loss: 0.0043\n","Epoch 2/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0043 - val_loss: 0.0039\n","Epoch 3/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0039 - val_loss: 0.0037\n","Epoch 4/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0037 - val_loss: 0.0036\n","Epoch 5/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0036 - val_loss: 0.0035\n","Epoch 6/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0036 - val_loss: 0.0035\n","Epoch 7/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0035 - val_loss: 0.0035\n","Epoch 8/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0035 - val_loss: 0.0034\n","Epoch 9/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0035 - val_loss: 0.0034\n","Epoch 10/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0035 - val_loss: 0.0035\n","Epoch 11/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0035 - val_loss: 0.0035\n","Epoch 12/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0035 - val_loss: 0.0034\n","Epoch 13/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0034 - val_loss: 0.0035\n","Epoch 14/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0034 - val_loss: 0.0034\n","Epoch 15/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0034 - val_loss: 0.0034\n","Epoch 16/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0034 - val_loss: 0.0035\n","Epoch 17/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0034 - val_loss: 0.0037\n","Epoch 18/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0034 - val_loss: 0.0034\n","Epoch 19/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0034 - val_loss: 0.0035\n","Epoch 20/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0034 - val_loss: 0.0034\n","model building for  New Hampshire Ave & T St NW  done\n","index =  10\n","model building for  14th & V St NW  start\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:11: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  # This is added back by InteractiveShellApp.init_path()\n","/usr/local/lib/python3.7/dist-packages/pandas/core/frame.py:4913: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  errors=errors,\n"]},{"output_type":"stream","name":"stdout","text":["Model: \"sequential_10\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," gru_20 (GRU)                (None, 168, 20)           3960      \n","                                                                 \n"," gru_21 (GRU)                (None, 10)                960       \n","                                                                 \n"," dropout_10 (Dropout)        (None, 10)                0         \n","                                                                 \n"," dense_20 (Dense)            (None, 10)                110       \n","                                                                 \n"," dense_21 (Dense)            (None, 1)                 11        \n","                                                                 \n","=================================================================\n","Total params: 5,041\n","Trainable params: 5,041\n","Non-trainable params: 0\n","_________________________________________________________________\n","Epoch 1/20\n","280/280 [==============================] - 24s 71ms/step - loss: 0.0125 - val_loss: 0.0064\n","Epoch 2/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0065 - val_loss: 0.0058\n","Epoch 3/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0061 - val_loss: 0.0056\n","Epoch 4/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0058 - val_loss: 0.0055\n","Epoch 5/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0057 - val_loss: 0.0053\n","Epoch 6/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0056 - val_loss: 0.0053\n","Epoch 7/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0055 - val_loss: 0.0053\n","Epoch 8/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0055 - val_loss: 0.0052\n","Epoch 9/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0055 - val_loss: 0.0052\n","Epoch 10/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0054 - val_loss: 0.0051\n","Epoch 11/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0054 - val_loss: 0.0051\n","Epoch 12/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0054 - val_loss: 0.0052\n","Epoch 13/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0054 - val_loss: 0.0050\n","Epoch 14/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0053 - val_loss: 0.0052\n","Epoch 15/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0053 - val_loss: 0.0052\n","Epoch 16/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0053 - val_loss: 0.0051\n","Epoch 17/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0053 - val_loss: 0.0051\n","Epoch 18/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0053 - val_loss: 0.0051\n","Epoch 19/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0052 - val_loss: 0.0051\n","Epoch 20/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0052 - val_loss: 0.0051\n","model building for  14th & V St NW  done\n","index =  11\n","model building for  Jefferson Memorial  start\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:11: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  # This is added back by InteractiveShellApp.init_path()\n","/usr/local/lib/python3.7/dist-packages/pandas/core/frame.py:4913: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  errors=errors,\n"]},{"output_type":"stream","name":"stdout","text":["Model: \"sequential_11\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," gru_22 (GRU)                (None, 168, 20)           3960      \n","                                                                 \n"," gru_23 (GRU)                (None, 10)                960       \n","                                                                 \n"," dropout_11 (Dropout)        (None, 10)                0         \n","                                                                 \n"," dense_22 (Dense)            (None, 10)                110       \n","                                                                 \n"," dense_23 (Dense)            (None, 1)                 11        \n","                                                                 \n","=================================================================\n","Total params: 5,041\n","Trainable params: 5,041\n","Non-trainable params: 0\n","_________________________________________________________________\n","Epoch 1/20\n","280/280 [==============================] - 24s 71ms/step - loss: 0.0047 - val_loss: 0.0029\n","Epoch 2/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0027 - val_loss: 0.0023\n","Epoch 3/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0022 - val_loss: 0.0021\n","Epoch 4/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0021 - val_loss: 0.0021\n","Epoch 5/20\n","280/280 [==============================] - 20s 70ms/step - loss: 0.0020 - val_loss: 0.0021\n","Epoch 6/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0020 - val_loss: 0.0020\n","Epoch 7/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0020 - val_loss: 0.0020\n","Epoch 8/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0020 - val_loss: 0.0020\n","Epoch 9/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0019 - val_loss: 0.0020\n","Epoch 10/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0019 - val_loss: 0.0020\n","Epoch 11/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0019 - val_loss: 0.0020\n","Epoch 12/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0019 - val_loss: 0.0019\n","Epoch 13/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0019 - val_loss: 0.0019\n","Epoch 14/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0019 - val_loss: 0.0019\n","Epoch 15/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0019 - val_loss: 0.0020\n","Epoch 16/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0019 - val_loss: 0.0020\n","Epoch 17/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0018 - val_loss: 0.0019\n","Epoch 18/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0018 - val_loss: 0.0019\n","Epoch 19/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0018 - val_loss: 0.0019\n","Epoch 20/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0018 - val_loss: 0.0019\n","model building for  Jefferson Memorial  done\n","index =  12\n","model building for  15th St & Constitution Ave NW  start\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:11: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  # This is added back by InteractiveShellApp.init_path()\n","/usr/local/lib/python3.7/dist-packages/pandas/core/frame.py:4913: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  errors=errors,\n"]},{"output_type":"stream","name":"stdout","text":["Model: \"sequential_12\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," gru_24 (GRU)                (None, 168, 20)           3960      \n","                                                                 \n"," gru_25 (GRU)                (None, 10)                960       \n","                                                                 \n"," dropout_12 (Dropout)        (None, 10)                0         \n","                                                                 \n"," dense_24 (Dense)            (None, 10)                110       \n","                                                                 \n"," dense_25 (Dense)            (None, 1)                 11        \n","                                                                 \n","=================================================================\n","Total params: 5,041\n","Trainable params: 5,041\n","Non-trainable params: 0\n","_________________________________________________________________\n","Epoch 1/20\n","280/280 [==============================] - 24s 72ms/step - loss: 0.0099 - val_loss: 0.0050\n","Epoch 2/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0046 - val_loss: 0.0043\n","Epoch 3/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0041 - val_loss: 0.0042\n","Epoch 4/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0040 - val_loss: 0.0042\n","Epoch 5/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0039 - val_loss: 0.0041\n","Epoch 6/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0039 - val_loss: 0.0041\n","Epoch 7/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0039 - val_loss: 0.0042\n","Epoch 8/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0038 - val_loss: 0.0040\n","Epoch 9/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0038 - val_loss: 0.0040\n","Epoch 10/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0038 - val_loss: 0.0040\n","Epoch 11/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0038 - val_loss: 0.0041\n","Epoch 12/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0038 - val_loss: 0.0040\n","Epoch 13/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0037 - val_loss: 0.0040\n","Epoch 14/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0037 - val_loss: 0.0041\n","Epoch 15/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0037 - val_loss: 0.0039\n","Epoch 16/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0037 - val_loss: 0.0039\n","Epoch 17/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0037 - val_loss: 0.0040\n","Epoch 18/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0037 - val_loss: 0.0040\n","Epoch 19/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0037 - val_loss: 0.0039\n","Epoch 20/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0037 - val_loss: 0.0039\n","model building for  15th St & Constitution Ave NW  done\n","index =  13\n","model building for  14th & Rhode Island Ave NW  start\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:11: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  # This is added back by InteractiveShellApp.init_path()\n","/usr/local/lib/python3.7/dist-packages/pandas/core/frame.py:4913: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  errors=errors,\n"]},{"output_type":"stream","name":"stdout","text":["Model: \"sequential_13\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," gru_26 (GRU)                (None, 168, 20)           3960      \n","                                                                 \n"," gru_27 (GRU)                (None, 10)                960       \n","                                                                 \n"," dropout_13 (Dropout)        (None, 10)                0         \n","                                                                 \n"," dense_26 (Dense)            (None, 10)                110       \n","                                                                 \n"," dense_27 (Dense)            (None, 1)                 11        \n","                                                                 \n","=================================================================\n","Total params: 5,041\n","Trainable params: 5,041\n","Non-trainable params: 0\n","_________________________________________________________________\n","Epoch 1/20\n","280/280 [==============================] - 24s 73ms/step - loss: 0.0216 - val_loss: 0.0065\n","Epoch 2/20\n","280/280 [==============================] - 19s 69ms/step - loss: 0.0076 - val_loss: 0.0063\n","Epoch 3/20\n","280/280 [==============================] - 19s 69ms/step - loss: 0.0068 - val_loss: 0.0063\n","Epoch 4/20\n","280/280 [==============================] - 19s 69ms/step - loss: 0.0065 - val_loss: 0.0061\n","Epoch 5/20\n","280/280 [==============================] - 19s 69ms/step - loss: 0.0064 - val_loss: 0.0063\n","Epoch 6/20\n","280/280 [==============================] - 19s 69ms/step - loss: 0.0063 - val_loss: 0.0060\n","Epoch 7/20\n","280/280 [==============================] - 19s 69ms/step - loss: 0.0062 - val_loss: 0.0060\n","Epoch 8/20\n","280/280 [==============================] - 19s 69ms/step - loss: 0.0061 - val_loss: 0.0061\n","Epoch 9/20\n","280/280 [==============================] - 19s 69ms/step - loss: 0.0061 - val_loss: 0.0059\n","Epoch 10/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0061 - val_loss: 0.0059\n","Epoch 11/20\n","280/280 [==============================] - 19s 69ms/step - loss: 0.0060 - val_loss: 0.0060\n","Epoch 12/20\n","280/280 [==============================] - 19s 69ms/step - loss: 0.0060 - val_loss: 0.0059\n","Epoch 13/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0060 - val_loss: 0.0059\n","Epoch 14/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0060 - val_loss: 0.0059\n","Epoch 15/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0060 - val_loss: 0.0058\n","Epoch 16/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0060 - val_loss: 0.0058\n","Epoch 17/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0059 - val_loss: 0.0058\n","Epoch 18/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0059 - val_loss: 0.0057\n","Epoch 19/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0059 - val_loss: 0.0059\n","Epoch 20/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0059 - val_loss: 0.0057\n","model building for  14th & Rhode Island Ave NW  done\n","index =  14\n","model building for  5th & K St NW  start\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:11: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  # This is added back by InteractiveShellApp.init_path()\n","/usr/local/lib/python3.7/dist-packages/pandas/core/frame.py:4913: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  errors=errors,\n"]},{"output_type":"stream","name":"stdout","text":["Model: \"sequential_14\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," gru_28 (GRU)                (None, 168, 20)           3960      \n","                                                                 \n"," gru_29 (GRU)                (None, 10)                960       \n","                                                                 \n"," dropout_14 (Dropout)        (None, 10)                0         \n","                                                                 \n"," dense_28 (Dense)            (None, 10)                110       \n","                                                                 \n"," dense_29 (Dense)            (None, 1)                 11        \n","                                                                 \n","=================================================================\n","Total params: 5,041\n","Trainable params: 5,041\n","Non-trainable params: 0\n","_________________________________________________________________\n","Epoch 1/20\n","280/280 [==============================] - 24s 71ms/step - loss: 0.0087 - val_loss: 0.0055\n","Epoch 2/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0057 - val_loss: 0.0048\n","Epoch 3/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0052 - val_loss: 0.0046\n","Epoch 4/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0050 - val_loss: 0.0045\n","Epoch 5/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0049 - val_loss: 0.0045\n","Epoch 6/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0048 - val_loss: 0.0044\n","Epoch 7/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0048 - val_loss: 0.0048\n","Epoch 8/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0047 - val_loss: 0.0043\n","Epoch 9/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0047 - val_loss: 0.0043\n","Epoch 10/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0046 - val_loss: 0.0044\n","Epoch 11/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0046 - val_loss: 0.0043\n","Epoch 12/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0046 - val_loss: 0.0042\n","Epoch 13/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0044 - val_loss: 0.0040\n","Epoch 14/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0043 - val_loss: 0.0040\n","Epoch 15/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0043 - val_loss: 0.0039\n","Epoch 16/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0042 - val_loss: 0.0039\n","Epoch 17/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0042 - val_loss: 0.0039\n","Epoch 18/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0042 - val_loss: 0.0039\n","Epoch 19/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0042 - val_loss: 0.0039\n","Epoch 20/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0041 - val_loss: 0.0039\n","model building for  5th & K St NW  done\n","index =  15\n","model building for  4th & M St SW  start\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:11: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  # This is added back by InteractiveShellApp.init_path()\n","/usr/local/lib/python3.7/dist-packages/pandas/core/frame.py:4913: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  errors=errors,\n"]},{"output_type":"stream","name":"stdout","text":["Model: \"sequential_15\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," gru_30 (GRU)                (None, 168, 20)           3960      \n","                                                                 \n"," gru_31 (GRU)                (None, 10)                960       \n","                                                                 \n"," dropout_15 (Dropout)        (None, 10)                0         \n","                                                                 \n"," dense_30 (Dense)            (None, 10)                110       \n","                                                                 \n"," dense_31 (Dense)            (None, 1)                 11        \n","                                                                 \n","=================================================================\n","Total params: 5,041\n","Trainable params: 5,041\n","Non-trainable params: 0\n","_________________________________________________________________\n","Epoch 1/20\n","280/280 [==============================] - 23s 71ms/step - loss: 0.0092 - val_loss: 0.0068\n","Epoch 2/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0068 - val_loss: 0.0063\n","Epoch 3/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0064 - val_loss: 0.0062\n","Epoch 4/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0062 - val_loss: 0.0060\n","Epoch 5/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0061 - val_loss: 0.0059\n","Epoch 6/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0060 - val_loss: 0.0060\n","Epoch 7/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0059 - val_loss: 0.0059\n","Epoch 8/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0059 - val_loss: 0.0060\n","Epoch 9/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0059 - val_loss: 0.0059\n","Epoch 10/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0059 - val_loss: 0.0059\n","Epoch 11/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0059 - val_loss: 0.0059\n","Epoch 12/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0059 - val_loss: 0.0058\n","Epoch 13/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0058 - val_loss: 0.0059\n","Epoch 14/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0058 - val_loss: 0.0059\n","Epoch 15/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0058 - val_loss: 0.0057\n","Epoch 16/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0058 - val_loss: 0.0059\n","Epoch 17/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0057 - val_loss: 0.0057\n","Epoch 18/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0057 - val_loss: 0.0058\n","Epoch 19/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0057 - val_loss: 0.0057\n","Epoch 20/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0056 - val_loss: 0.0057\n","model building for  4th & M St SW  done\n","index =  16\n","model building for  8th & O St NW  start\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:11: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  # This is added back by InteractiveShellApp.init_path()\n","/usr/local/lib/python3.7/dist-packages/pandas/core/frame.py:4913: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  errors=errors,\n"]},{"output_type":"stream","name":"stdout","text":["Model: \"sequential_16\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," gru_32 (GRU)                (None, 168, 20)           3960      \n","                                                                 \n"," gru_33 (GRU)                (None, 10)                960       \n","                                                                 \n"," dropout_16 (Dropout)        (None, 10)                0         \n","                                                                 \n"," dense_32 (Dense)            (None, 10)                110       \n","                                                                 \n"," dense_33 (Dense)            (None, 1)                 11        \n","                                                                 \n","=================================================================\n","Total params: 5,041\n","Trainable params: 5,041\n","Non-trainable params: 0\n","_________________________________________________________________\n","Epoch 1/20\n","280/280 [==============================] - 23s 71ms/step - loss: 0.0097 - val_loss: 0.0070\n","Epoch 2/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0072 - val_loss: 0.0067\n","Epoch 3/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0069 - val_loss: 0.0064\n","Epoch 4/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0066 - val_loss: 0.0063\n","Epoch 5/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0065 - val_loss: 0.0064\n","Epoch 6/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0065 - val_loss: 0.0063\n","Epoch 7/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0064 - val_loss: 0.0063\n","Epoch 8/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0064 - val_loss: 0.0063\n","Epoch 9/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0064 - val_loss: 0.0066\n","Epoch 10/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0063 - val_loss: 0.0062\n","Epoch 11/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0063 - val_loss: 0.0062\n","Epoch 12/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0063 - val_loss: 0.0061\n","Epoch 13/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0062 - val_loss: 0.0062\n","Epoch 14/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0062 - val_loss: 0.0062\n","Epoch 15/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0062 - val_loss: 0.0061\n","Epoch 16/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0062 - val_loss: 0.0061\n","Epoch 17/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0062 - val_loss: 0.0064\n","Epoch 18/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0062 - val_loss: 0.0061\n","Epoch 19/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0062 - val_loss: 0.0061\n","Epoch 20/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0062 - val_loss: 0.0061\n","model building for  8th & O St NW  done\n","index =  17\n","model building for  Thomas Circle  start\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:11: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  # This is added back by InteractiveShellApp.init_path()\n","/usr/local/lib/python3.7/dist-packages/pandas/core/frame.py:4913: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  errors=errors,\n"]},{"output_type":"stream","name":"stdout","text":["Model: \"sequential_17\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," gru_34 (GRU)                (None, 168, 20)           3960      \n","                                                                 \n"," gru_35 (GRU)                (None, 10)                960       \n","                                                                 \n"," dropout_17 (Dropout)        (None, 10)                0         \n","                                                                 \n"," dense_34 (Dense)            (None, 10)                110       \n","                                                                 \n"," dense_35 (Dense)            (None, 1)                 11        \n","                                                                 \n","=================================================================\n","Total params: 5,041\n","Trainable params: 5,041\n","Non-trainable params: 0\n","_________________________________________________________________\n","Epoch 1/20\n","280/280 [==============================] - 23s 70ms/step - loss: 0.0084 - val_loss: 0.0047\n","Epoch 2/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0050 - val_loss: 0.0043\n","Epoch 3/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0047 - val_loss: 0.0042\n","Epoch 4/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0046 - val_loss: 0.0041\n","Epoch 5/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0044 - val_loss: 0.0040\n","Epoch 6/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0044 - val_loss: 0.0041\n","Epoch 7/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0043 - val_loss: 0.0040\n","Epoch 8/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0043 - val_loss: 0.0042\n","Epoch 9/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0042 - val_loss: 0.0039\n","Epoch 10/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0042 - val_loss: 0.0039\n","Epoch 11/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0042 - val_loss: 0.0038\n","Epoch 12/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0041 - val_loss: 0.0038\n","Epoch 13/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0040 - val_loss: 0.0037\n","Epoch 14/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0040 - val_loss: 0.0037\n","Epoch 15/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0039 - val_loss: 0.0036\n","Epoch 16/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0038 - val_loss: 0.0037\n","Epoch 17/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0037 - val_loss: 0.0036\n","Epoch 18/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0037 - val_loss: 0.0035\n","Epoch 19/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0037 - val_loss: 0.0035\n","Epoch 20/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0036 - val_loss: 0.0035\n","model building for  Thomas Circle  done\n","index =  18\n","model building for  11th & M St NW  start\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:11: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  # This is added back by InteractiveShellApp.init_path()\n","/usr/local/lib/python3.7/dist-packages/pandas/core/frame.py:4913: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  errors=errors,\n"]},{"output_type":"stream","name":"stdout","text":["Model: \"sequential_18\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," gru_36 (GRU)                (None, 168, 20)           3960      \n","                                                                 \n"," gru_37 (GRU)                (None, 10)                960       \n","                                                                 \n"," dropout_18 (Dropout)        (None, 10)                0         \n","                                                                 \n"," dense_36 (Dense)            (None, 10)                110       \n","                                                                 \n"," dense_37 (Dense)            (None, 1)                 11        \n","                                                                 \n","=================================================================\n","Total params: 5,041\n","Trainable params: 5,041\n","Non-trainable params: 0\n","_________________________________________________________________\n","Epoch 1/20\n","280/280 [==============================] - 24s 74ms/step - loss: 0.0085 - val_loss: 0.0056\n","Epoch 2/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0056 - val_loss: 0.0054\n","Epoch 3/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0053 - val_loss: 0.0052\n","Epoch 4/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0051 - val_loss: 0.0051\n","Epoch 5/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0050 - val_loss: 0.0052\n","Epoch 6/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0050 - val_loss: 0.0052\n","Epoch 7/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0050 - val_loss: 0.0051\n","Epoch 8/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0049 - val_loss: 0.0051\n","Epoch 9/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0049 - val_loss: 0.0051\n","Epoch 10/20\n","280/280 [==============================] - 19s 68ms/step - loss: 0.0049 - val_loss: 0.0051\n","Epoch 11/20\n","280/280 [==============================] - 19s 67ms/step - loss: 0.0049 - val_loss: 0.0051\n","Epoch 12/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0048 - val_loss: 0.0050\n","Epoch 13/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0048 - val_loss: 0.0051\n","Epoch 14/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0048 - val_loss: 0.0051\n","Epoch 15/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0048 - val_loss: 0.0050\n","Epoch 16/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0048 - val_loss: 0.0050\n","Epoch 17/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0048 - val_loss: 0.0050\n","Epoch 18/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0048 - val_loss: 0.0050\n","Epoch 19/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0048 - val_loss: 0.0050\n","Epoch 20/20\n","280/280 [==============================] - 19s 66ms/step - loss: 0.0048 - val_loss: 0.0051\n","model building for  11th & M St NW  done\n","index =  19\n","model building for  14th & Irving St NW  start\n"]},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:11: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  # This is added back by InteractiveShellApp.init_path()\n","/usr/local/lib/python3.7/dist-packages/pandas/core/frame.py:4913: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  errors=errors,\n"]},{"output_type":"stream","name":"stdout","text":["Model: \"sequential_19\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," gru_38 (GRU)                (None, 168, 20)           3960      \n","                                                                 \n"," gru_39 (GRU)                (None, 10)                960       \n","                                                                 \n"," dropout_19 (Dropout)        (None, 10)                0         \n","                                                                 \n"," dense_38 (Dense)            (None, 10)                110       \n","                                                                 \n"," dense_39 (Dense)            (None, 1)                 11        \n","                                                                 \n","=================================================================\n","Total params: 5,041\n","Trainable params: 5,041\n","Non-trainable params: 0\n","_________________________________________________________________\n","Epoch 1/20\n","280/280 [==============================] - 23s 69ms/step - loss: 0.0110 - val_loss: 0.0085\n","Epoch 2/20\n","280/280 [==============================] - 18s 65ms/step - loss: 0.0085 - val_loss: 0.0078\n","Epoch 3/20\n","280/280 [==============================] - 18s 65ms/step - loss: 0.0081 - val_loss: 0.0078\n","Epoch 4/20\n","280/280 [==============================] - 18s 65ms/step - loss: 0.0079 - val_loss: 0.0076\n","Epoch 5/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0078 - val_loss: 0.0077\n","Epoch 6/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0078 - val_loss: 0.0076\n","Epoch 7/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0077 - val_loss: 0.0076\n","Epoch 8/20\n","280/280 [==============================] - 18s 65ms/step - loss: 0.0076 - val_loss: 0.0076\n","Epoch 9/20\n","280/280 [==============================] - 18s 65ms/step - loss: 0.0076 - val_loss: 0.0076\n","Epoch 10/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0076 - val_loss: 0.0075\n","Epoch 11/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0076 - val_loss: 0.0075\n","Epoch 12/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0076 - val_loss: 0.0075\n","Epoch 13/20\n","280/280 [==============================] - 18s 65ms/step - loss: 0.0075 - val_loss: 0.0076\n","Epoch 14/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0076 - val_loss: 0.0075\n","Epoch 15/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0075 - val_loss: 0.0076\n","Epoch 16/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0075 - val_loss: 0.0075\n","Epoch 17/20\n","280/280 [==============================] - 18s 65ms/step - loss: 0.0074 - val_loss: 0.0073\n","Epoch 18/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0072 - val_loss: 0.0073\n","Epoch 19/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0071 - val_loss: 0.0071\n","Epoch 20/20\n","280/280 [==============================] - 18s 66ms/step - loss: 0.0070 - val_loss: 0.0072\n","model building for  14th & Irving St NW  done\n"]}],"source":["# ÁÇ∫ÊØèÂÄãÁ´ôÈªûÂª∫Ê®°\n","\n","# ÂâµÈÄ†Áõ∏ÂêåÊôÇÈñìÈñìÈöîÁöÑtime column\n","from datetime import datetime , timedelta\n","from pandas import DataFrame\n","all_time = []\n","start_time = datetime.strptime(\"2018-01-01 00:00:00\" , \"%Y-%m-%d %H:%M:%S\")    \n","end_time = datetime.strptime(\"2021-12-31 23:00:00\" , \"%Y-%m-%d %H:%M:%S\")    \n","current_date = start_time.date()\n","\n","while current_date <= end_time.date() :\n","  i = 0\n","  for i in range (0,24) :\n","    current_data_str = current_date.strftime(\"%Y-%m-%d\") \n","    all_time.append(\"%s\"%str(current_data_str)+\" %i:00:00\"%(i))\n","    i = i+1 \n","  current_date = current_date + timedelta(days=1)\n","  \n","all_time = pd.DataFrame(all_time)\n","all_time.columns = [\"Time\"]\n","all_time['Time'] = pd.to_datetime(all_time['Time'])\n","# print('all_time data')\n","# print(all_time)\n","index = 0\n","\n","#right order\n","for station in station_rank:\n","  print('index = ', index)\n","  print('model building for ', station, ' start')\n","  picked_station_data = produce_picked_station_data(start_st_model, station)\n","  picked_station_data = feature_engineering(picked_station_data, all_time)\n","  # print('check data')\n","  # print(picked_station_data)\n","  picked_station_data = scaling(picked_station_data, 'to_cnt')\n","  x_train, y_train = build_training_data(picked_station_data, used_days=7)\n","  x_train, y_train = shuffle(x_train,y_train)\n","  x_train, y_train, x_val, y_val = build_training_and_validation_data(x_train, y_train, 0.2)\n","  \n","  model = buildManyToOneModel(x_train.shape)\n","  callback = EarlyStopping(monitor=\"loss\", patience=10, verbose=1, mode=\"auto\")\n","  history = model.fit(x_train, y_train, epochs=20, batch_size=100, validation_data=(x_val, y_val), callbacks=[callback])\n","  #ÂÑ≤Â≠òÊ®°Âûã\n","  path = \"/content/drive/MyDrive/Â∞àÈ°åÁ†îÁ©∂üí™/sharingbike/GRUModel/ToModel_station\" + str(index)\n","  path += '.h5'\n","  model.save(path)\n","  index += 1\n","  print('model building for ', station, ' done')\n","  \n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"a7Hil5V9MfN3","colab":{"base_uri":"https://localhost:8080/","height":312},"executionInfo":{"status":"ok","timestamp":1652738922130,"user_tz":-480,"elapsed":796,"user":{"displayName":"Ê±üË©†Á≠ë","userId":"04064959354435451143"}},"outputId":"d401da44-22a4-4c5d-ee49-a603d930a12f"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["[<matplotlib.lines.Line2D at 0x7f8796cecad0>]"]},"metadata":{},"execution_count":8},{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}],"source":["# È°ØÁ§∫loss\n","import matplotlib.pyplot as plt\n","\n","plt.title(\"Train_Loss\")\n","plt.ylabel(\"Loss\")\n","plt.xlabel('Epoch')\n","plt.plot(history.history[\"loss\"])\n","plt.plot(history.history[\"val_loss\"])"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"sfW6mZQuMkrL","colab":{"base_uri":"https://localhost:8080/","height":237},"executionInfo":{"status":"error","timestamp":1652738923548,"user_tz":-480,"elapsed":1448,"user":{"displayName":"Ê±üË©†Á≠ë","userId":"04064959354435451143"}},"outputId":"3d8a080d-ae58-447e-a03f-b6e29df3b2aa"},"outputs":[{"output_type":"error","ename":"NameError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-9-b7026661b562>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mpredictions\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mpredict\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mX_val\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      2\u001b[0m \u001b[0mpredictions\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mscaler\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0minverse_transform\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpredictions\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0mpredictions\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mpd\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mDataFrame\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mpredictions\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mrename\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcolumns\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m{\u001b[0m\u001b[0;36m0\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m'È†êÊ∏¨ÂÄº'\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m \u001b[0mY_val_inverse\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mscaler\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0minverse_transform\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mY_val\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mNameError\u001b[0m: name 'X_val' is not defined"]}],"source":["predictions = model.predict(X_val)\n","predictions = scaler.inverse_transform(predictions)\n","predictions = pd.DataFrame(predictions).rename(columns={0:'È†êÊ∏¨ÂÄº'})\n","                                               \n","Y_val_inverse = scaler.inverse_transform(Y_val)\n","Y_val_inverse = pd.DataFrame(Y_val_inverse).rename(columns={0:'ÂØ¶ÈöõÂÄº'})\n","\n","final = pd.concat([predictions,Y_val_inverse],axis=1)\n","final"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"Cip3L2dSKZlX"},"outputs":[],"source":["import matplotlib.pyplot as plt\n","plt.plot(predictions)\n","plt.plot(Y_val_inverse)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qYLUfBfoSoW5"},"outputs":[],"source":["plt.plot(Y_val_inverse)\n","plt.plot(predictions)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"qOI02ZbjTMhz"},"outputs":[],"source":["#ÂÑ≤Â≠òÊ®°Âûã\n","station_index = 1\n","path = \"/content/drive/MyDrive/Â∞àÈ°åÁ†îÁ©∂üí™/sharingbike/GRUmodel/FromModel_station\" + str(station_index)\n","path += '.h5'\n","model.save(path)"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"7Nr7tADu3ecJ"},"outputs":[],"source":["# Ë©ï‰º∞Ê®°Âûã\n","# loss, accuracy = model.evaluate(x_train, y_train)\n","# print(\"Ë®ìÁ∑¥Ë≥áÊñôÈõÜÁöÑÊ∫ñÁ¢∫Â∫¶ = {:.2f}\".format(accuracy))\n","# loss, accuracy = model.evaluate(x_test, y_test)\n","# print(\"Ê∏¨Ë©¶Ë≥áÊñôÈõÜÁöÑÊ∫ñÁ¢∫Â∫¶ = {:.2f}\".format(accuracy))"]}],"metadata":{"colab":{"name":"5/17ÈÄ≤Á´ômodel (GRU2) ","provenance":[{"file_id":"1mfyQYCP6b3ZKkx6U2IW3pR32ZxCKcWrq","timestamp":1652710284426}],"collapsed_sections":[]},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"accelerator":"GPU"},"nbformat":4,"nbformat_minor":0}